import{a as e}from"./chunk-ClPlP9YV.js";import"./chunk-Boel6EIc.js";const t=e=>{if(!e)return"";return`https://admin.shilpgroup.com${e.startsWith("/")?e:`/${e}`}`},a={BASE_URL:"https://backend.shilpgroup.com",ENDPOINTS:{ADMIN:{LOGIN:"/api/admin/login",VERIFY_TOKEN:"/api/admin/verify-token",FORGOT_PASSWORD:"/api/admin/forgot-password",PROFILE:"/api/admin/profile"}},TIMEOUT:3e4};class r extends Error{status;code;constructor(e,t,a){super(e),this.name="ApiError",this.status=t,this.code=a}}const o={async request(t,o={}){const s=`${a.BASE_URL}${t}`,n={"Content-Type":"application/json",Accept:"application/json","Access-Control-Allow-Origin":"*",...Object.fromEntries(Object.entries(o.headers||{}).map(([e,t])=>[e,t??""]))},i=localStorage.getItem("adminToken");i&&(n.Authorization=`Bearer ${i}`),console.log("ðŸ”— Making API request to:",s);try{const t={url:s,method:o.method||"GET",headers:n,data:o.data,timeout:a.TIMEOUT,withCredentials:!1},i=await e.request(t);if(console.log("âœ… API Response received:",i.status),!i.data.success)throw new r(i.data.error?.message||i.data.message||"Request failed",i.status,i.data.error?.code);return i.data}catch(d){if(console.error("âŒ API Request failed:",d),d instanceof r)throw d;if(e.isAxiosError(d)){if(console.error("ðŸŒ Axios Error Details:",{code:d.code,message:d.message,status:d.response?.status,url:d.config?.url}),"ECONNABORTED"===d.code)throw new r("Connection timeout - Please check your internet connection and try again",408,"TIMEOUT");if("ERR_NETWORK"===d.code)throw new r("Network error - Unable to connect to server",0,"NETWORK_ERROR");if(404===d.response?.status)throw new r("API endpoint not found",404,"NOT_FOUND");if(500===d.response?.status)throw new r("Server error - Please try again later",500,"SERVER_ERROR");throw new r(d.response?.data?.error?.message||d.message||"Network connection failed",d.response?.status||0,d.response?.data?.error?.code||"NETWORK_ERROR")}throw new r("Unexpected error occurred",0,"UNKNOWN_ERROR")}},get(e){return this.request(e,{method:"GET"})},post(e,t){return this.request(e,{method:"POST",data:t})},put(e,t){return this.request(e,{method:"PUT",data:t})},delete(e){return this.request(e,{method:"DELETE"})}},s=()=>{localStorage.removeItem("adminToken"),localStorage.removeItem("adminData")},n={login:async e=>{try{const t=await o.post(a.ENDPOINTS.ADMIN.LOGIN,e);if(t.success&&t.data)return localStorage.setItem("adminToken",t.data.token),localStorage.setItem("adminData",JSON.stringify(t.data.admin)),t.data;throw new r(t.error?.message||"Login failed",400,t.error?.code)}catch(t){if(t instanceof r)throw t;throw new r("Login request failed",500,"LOGIN_ERROR")}},verifyToken:async()=>{try{const e=localStorage.getItem("adminToken");if(!e)throw new r("No token found",401,"NO_TOKEN");const t=await o.post(a.ENDPOINTS.ADMIN.VERIFY_TOKEN,{token:e});if(t.success&&t.data)return t.data;throw new r(t.error?.message||"Token verification failed",401,t.error?.code)}catch(e){if(s(),e instanceof r)throw e;throw new r("Token verification failed",500,"TOKEN_ERROR")}},getProfile:async()=>{try{const e=await o.get(a.ENDPOINTS.ADMIN.PROFILE);if(e.success&&e.data)return localStorage.setItem("adminData",JSON.stringify(e.data)),e.data;throw new r(e.error?.message||"Failed to fetch profile",400,e.error?.code)}catch(e){if(e instanceof r)throw e;throw new r("Profile request failed",500,"PROFILE_ERROR")}},forgotPassword:async e=>{try{const t=await o.post(a.ENDPOINTS.ADMIN.FORGOT_PASSWORD,{email:e});if(t.success&&t.data)return t.data;throw new r(t.error?.message||"Failed to send reset email",400,t.error?.code)}catch(t){if(t instanceof r)throw t;throw new r("Forgot password request failed",500,"FORGOT_PASSWORD_ERROR")}},logout:s,isLoggedIn:()=>{const e=localStorage.getItem("adminToken"),t=localStorage.getItem("adminData");return!(!e||!t)},getStoredAdminData:()=>{try{const e=localStorage.getItem("adminData");return e?JSON.parse(e):null}catch(e){return console.error("Error parsing admin data:",e),null}},getStoredToken:()=>localStorage.getItem("adminToken")},i=e.create({baseURL:a.BASE_URL,timeout:a.TIMEOUT});i.interceptors.request.use(e=>{const t=localStorage.getItem("adminToken");return t&&(e.headers.Authorization=`Bearer ${t}`),e});const d=async()=>{try{return(await i.get("/api/banners")).data}catch(e){console.error("âŒ Banner API request failed:",e);const t=e instanceof Error?e.message:e?.response?.data?.message;throw new Error(t||"Failed to fetch banners")}},c=async(e,t,a,r)=>{try{const o=new FormData;o.append("image",a),r&&o.append("alt",r);return(await i.post(`/api/banners/${e}/${t}`,o,{headers:{"Content-Type":"multipart/form-data"}})).data}catch(o){const e=o instanceof Error?o.message:o?.response?.data?.message;throw new Error(e||"Failed to upload banner image")}},p=async(e,t)=>{try{return(await i.put(`/api/banners/${e}/alt`,{alt:t})).data}catch(a){const e=a instanceof Error?a.message:a?.response?.data?.message;throw new Error(e||"Failed to update alt text")}},l=async(e,t)=>{try{return(await i.put("/api/banners/blogsDetail/text",{title:e,description:t})).data}catch(a){const e=a instanceof Error?a.message:a?.response?.data?.message;throw new Error(e||"Failed to update blogs text")}},u=async(e,t)=>{try{return(await i.delete(`/api/banners/${e}/${t}`)).data}catch(a){const e=a instanceof Error?a.message:a?.response?.data?.message;throw new Error(e||"Failed to delete banner image")}},g=e.create({baseURL:a.BASE_URL,timeout:a.TIMEOUT});g.interceptors.request.use(e=>{const t=localStorage.getItem("adminToken");return t&&(e.headers.Authorization=`Bearer ${t}`),e});const m={async createBlog(e,t){const a=new FormData;a.append("title",e.title),a.append("description",e.description),a.append("publish",e.publish||"By Shilp Group"),a.append("date",e.date),a.append("url",e.url),a.append("alt",e.alt||""),a.append("status",e.status||"draft"),a.append("points",JSON.stringify(e.points)),t.mainImage&&a.append("image",t.mainImage),t.pointImages&&Object.entries(t.pointImages).forEach(([e,t])=>{a.append(`point_${e}_image`,t)});return(await g.post("/api/blogs",a,{headers:{"Content-Type":"multipart/form-data"}})).data.data},async getAllBlogs(e){const t=e?{status:e}:{};return(await g.get("/api/blogs",{params:t})).data.data},getBlogById:async e=>(await g.get(`/api/blogs/${e}`)).data.data,getBlogByUrl:async e=>(await g.get(`/api/blogs/url/${e}`)).data.data,async updateBlog(e,t,a){const r=new FormData;t.title&&r.append("title",t.title),t.description&&r.append("description",t.description),t.publish&&r.append("publish",t.publish),t.date&&r.append("date",t.date),t.url&&r.append("url",t.url),void 0!==t.alt&&r.append("alt",t.alt),t.status&&r.append("status",t.status),t.points&&r.append("points",JSON.stringify(t.points)),a?.mainImage&&r.append("image",a.mainImage),a?.pointImages&&Object.entries(a.pointImages).forEach(([e,t])=>{r.append(`point_${e}_image`,t)});return(await g.put(`/api/blogs/${e}`,r,{headers:{"Content-Type":"multipart/form-data"}})).data.data},async deleteBlog(e){await g.delete(`/api/blogs/${e}`)}},h=(e,t=!0)=>{if(!e||""===e.trim())return"";const a="https://mail.shilpgroup.com";let r="";if(r=e.startsWith("http://")||e.startsWith("https://")?e:e.startsWith("/uploads/")?`${a}${e}`:e.startsWith("uploads/")?`${a}/${e}`:e.includes("/")?`${a}/${e.startsWith("/")?e.substring(1):e}`:`${a}/uploads/banners/${e}`,t&&r){const e=r.includes("?")?"&":"?";r+=`${e}t=${Date.now()}`}return r},w=e=>{if(0===e)return"0 B";const t=Math.floor(Math.log(e)/Math.log(1024));return`${parseFloat((e/Math.pow(1024,t)).toFixed(1))} ${["B","KB","MB","GB"][t]}`},f=e=>{if(!e)return"Unknown";try{return new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return"Invalid date"}},E={formatError:e=>e instanceof r||e instanceof Error?e.message:"An unexpected error occurred",isNetworkError:e=>e instanceof r&&("NETWORK_ERROR"===e.code||0===e.status),isAuthError:e=>e instanceof r&&(401===e.status||"TOKEN_ERROR"===e.code),isTimeoutError:e=>e instanceof r&&"TIMEOUT"===e.code};export{n as A,E as a,d as b,l as c,f as d,u as e,w as f,h as g,p as h,a as i,m as j,t as k,c as u};
